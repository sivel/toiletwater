- name: Create go path
  file:
    state: directory
    path: "{{ remote_tmp_dir }}/go"

- name: Install gopkg.in/yaml.v2
  go:
    state: present
    name: gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is changed

- name: Install gopkg.in/yaml.v2
  go:
    state: present
    name: gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is not changed

- environment:
    GOPATH: "{{ remote_tmp_dir }}/go"
  block:
    - command: go list gopkg.in/yaml.v2
    - command: go clean -cache -i gopkg.in/yaml.v2

- name: Uninstall gopkg.in/yaml.v2
  go:
    state: absent
    name: gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is changed

- name: Uninstall gopkg.in/yaml.v2
  go:
    state: absent
    name: gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is not changed

- name: Install gopkg.in/yaml.v2
  go:
    state: present
    name: gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is changed

- name: Uninstall gopkg.in/yaml.v2
  go:
    state: absent
    name: gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is changed

- name: Install gopkg.in/yaml.v1 and gopkg.in/yaml.v2
  go:
    state: present
    name:
      - gopkg.in/yaml.v1
      - gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is changed

- name: Install gopkg.in/yaml.v1 and gopkg.in/yaml.v2
  go:
    state: present
    name:
      - gopkg.in/yaml.v1
      - gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is not changed

- name: Uninstall gopkg.in/yaml.v1 and gopkg.in/yaml.v2
  go:
    state: absent
    name:
      - gopkg.in/yaml.v1
      - gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is changed

- name: Uninstall gopkg.in/yaml.v1 and gopkg.in/yaml.v2
  go:
    state: absent
    name:
      - gopkg.in/yaml.v1
      - gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is not changed

- name: Install gopkg.in/yaml.v1 and gopkg.in/yaml.v2
  go:
    state: present
    name:
      - gopkg.in/yaml.v1
      - gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is changed

- name: Uninstall gopkg.in/yaml.v1
  go:
    state: absent
    name:
      - gopkg.in/yaml.v1
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is changed

- name: Install gopkg.in/yaml.v2
  go:
    state: present
    name: gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
  register: result

- assert:
    that:
      - result is not changed

- name: Uninstall gopkg.in/yaml.v2
  go:
    state: absent
    name: gopkg.in/yaml.v2
    go_path: "{{ remote_tmp_dir }}/go"
